{"version":3,"sources":["webpack:///webpack/universalModuleDefinition","webpack:///webpack/bootstrap 167066b8fe58f17fbc41","webpack:///./src/index.js","webpack:///external {\"amd\":\"js-data\",\"commonjs\":\"js-data\",\"commonjs2\":\"js-data\",\"root\":\"JSData\"}","webpack:///./~/mout/random/guid.js","webpack:///./~/mout/random/randHex.js","webpack:///./~/mout/random/choice.js","webpack:///./~/mout/random/randInt.js","webpack:///./~/mout/number/MIN_INT.js","webpack:///./~/mout/number/MAX_INT.js","webpack:///./~/mout/random/rand.js","webpack:///./~/mout/random/random.js","webpack:///./~/mout/lang/isArray.js","webpack:///./~/mout/lang/isKind.js","webpack:///./~/mout/lang/kindOf.js"],"names":[],"mappings":"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","file":"./dist/js-data-localstorage.js","sourcesContent":["(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory(require(\"js-data\"));\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine([\"js-data\"], factory);\n\telse if(typeof exports === 'object')\n\t\texports[\"LocalStorageAdapter\"] = factory(require(\"js-data\"));\n\telse\n\t\troot[\"LocalStorageAdapter\"] = factory(root[\"JSData\"]);\n})(this, function(__WEBPACK_EXTERNAL_MODULE_1__) {\nreturn \n\n\n/** WEBPACK FOOTER **\n ** webpack/universalModuleDefinition\n **/"," \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId])\n \t\t\treturn installedModules[moduleId].exports;\n\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\texports: {},\n \t\t\tid: moduleId,\n \t\t\tloaded: false\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.loaded = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(0);\n\n\n\n/** WEBPACK FOOTER **\n ** webpack/bootstrap 167066b8fe58f17fbc41\n **/","/* global: localStorage */\r\nconst JSData = require('js-data')\r\nconst guid = require('mout/random/guid')\r\n\r\nconst {\r\n  Query,\r\n  utils\r\n} = JSData\r\n\r\nconst {\r\n  addHiddenPropsToTarget,\r\n  deepMixIn,\r\n  extend,\r\n  fillIn,\r\n  forEachRelation,\r\n  forOwn,\r\n  fromJson,\r\n  get,\r\n  isArray,\r\n  isUndefined,\r\n  resolve,\r\n  reject,\r\n  set,\r\n  toJson\r\n} = utils\r\n\r\nfunction isValidString (value) {\r\n  return (value != null && value !== '')\r\n}\r\nfunction join (items, separator) {\r\n  separator || (separator = '')\r\n  return items.filter(isValidString).join(separator)\r\n}\r\nfunction makePath (...args) {\r\n  let result = join(args, '/')\r\n  return result.replace(/([^:\\/]|^)\\/{2,}/g, '$1/')\r\n}\r\nfunction unique (array) {\r\n  const seen = {}\r\n  const final = []\r\n  array.forEach(function (item) {\r\n    if (item in seen) {\r\n      return\r\n    }\r\n    final.push(item)\r\n    seen[item] = 0\r\n  })\r\n  return final\r\n}\r\nlet queue = []\r\nlet taskInProcess = false\r\n\r\nfunction enqueue (task) {\r\n  queue.push(task)\r\n}\r\n\r\nfunction dequeue () {\r\n  if (queue.length && !taskInProcess) {\r\n    taskInProcess = true\r\n    queue[0]()\r\n  }\r\n}\r\n\r\nfunction queueTask (task) {\r\n  if (!queue.length) {\r\n    enqueue(task)\r\n    dequeue()\r\n  } else {\r\n    enqueue(task)\r\n  }\r\n}\r\n\r\nfunction createTask (fn) {\r\n  return new Promise(fn).then(function (result) {\r\n    taskInProcess = false\r\n    queue.shift()\r\n    setTimeout(dequeue, 0)\r\n    return result\r\n  }, function (err) {\r\n    taskInProcess = false\r\n    queue.shift()\r\n    setTimeout(dequeue, 0)\r\n    return reject(err)\r\n  })\r\n}\r\n\r\nconst noop = function (...args) {\r\n  const self = this\r\n  const opts = args[args.length - 1]\r\n  self.dbg(opts.op, ...args)\r\n  return resolve()\r\n}\r\n\r\nconst noop2 = function (...args) {\r\n  const self = this\r\n  const opts = args[args.length - 2]\r\n  self.dbg(opts.op, ...args)\r\n  return resolve()\r\n}\r\n\r\nconst DEFAULTS = {\r\n  /**\r\n   * TODO\r\n   *\r\n   * @name LocalStorageAdapter#basePath\r\n   * @type {string}\r\n   */\r\n  basePath: '',\r\n\r\n  /**\r\n   * TODO\r\n   *\r\n   * @name LocalStorageAdapter#debug\r\n   * @type {boolean}\r\n   * @default false\r\n   */\r\n  debug: false,\r\n\r\n  /**\r\n   * TODO\r\n   *\r\n   * @name LocalStorageAdapter#storage\r\n   * @type {Object}\r\n   * @default localStorage\r\n   */\r\n  storage: localStorage\r\n}\r\n\r\n/**\r\n * LocalStorageAdapter class.\r\n *\r\n * @example\r\n * import {DataStore} from 'js-data'\r\n * import LocalStorageAdapter from 'js-data-localstorage'\r\n * const store = new DataStore()\r\n * const adapter = new LocalStorageAdapter()\r\n * store.registerAdapter('ls', adapter, { 'default': true })\r\n *\r\n * @class LocalStorageAdapter\r\n * @param {Object} [opts] Configuration opts.\r\n * @param {string} [opts.basePath=''] TODO\r\n * @param {boolean} [opts.debug=false] TODO\r\n * @param {Object} [opts.storeage=localStorage] TODO\r\n */\r\nfunction LocalStorageAdapter (opts) {\r\n  fillIn(this, opts || {})\r\n  fillIn(this, DEFAULTS)\r\n}\r\n\r\n/**\r\n * Alternative to ES6 class syntax for extending `LocalStorageAdapter`.\r\n *\r\n * @name LocalStorageAdapter.extend\r\n * @method\r\n * @param {Object} [instanceProps] Properties that will be added to the\r\n * prototype of the subclass.\r\n * @param {Object} [classProps] Properties that will be added as static\r\n * properties to the subclass itself.\r\n * @return {Object} Subclass of `LocalStorageAdapter`.\r\n */\r\nLocalStorageAdapter.extend = extend\r\n\r\naddHiddenPropsToTarget(LocalStorageAdapter.prototype, {\r\n  /**\r\n   * @name LocalStorageAdapter#afterCreate\r\n   * @method\r\n   */\r\n  afterCreate: noop2,\r\n\r\n  /**\r\n   * @name LocalStorageAdapter#afterCreateMany\r\n   * @method\r\n   */\r\n  afterCreateMany: noop2,\r\n\r\n  /**\r\n   * @name LocalStorageAdapter#afterDEL\r\n   * @method\r\n   */\r\n  afterDEL: noop2,\r\n\r\n  /**\r\n   * @name LocalStorageAdapter#afterDestroy\r\n   * @method\r\n   */\r\n  afterDestroy: noop2,\r\n\r\n  /**\r\n   * @name LocalStorageAdapter#afterDestroyAll\r\n   * @method\r\n   */\r\n  afterDestroyAll: noop2,\r\n\r\n  /**\r\n   * @name LocalStorageAdapter#afterFind\r\n   * @method\r\n   */\r\n  afterFind: noop2,\r\n\r\n  /**\r\n   * @name LocalStorageAdapter#afterFindAll\r\n   * @method\r\n   */\r\n  afterFindAll: noop2,\r\n\r\n  /**\r\n   * @name LocalStorageAdapter#afterGET\r\n   * @method\r\n   */\r\n  afterGET: noop2,\r\n\r\n  /**\r\n   * @name LocalStorageAdapter#afterPUT\r\n   * @method\r\n   */\r\n  afterPUT: noop2,\r\n\r\n  /**\r\n   * @name LocalStorageAdapter#afterUpdate\r\n   * @method\r\n   */\r\n  afterUpdate: noop2,\r\n\r\n  /**\r\n   * @name LocalStorageAdapter#afterUpdateAll\r\n   * @method\r\n   */\r\n  afterUpdateAll: noop2,\r\n\r\n  /**\r\n   * @name LocalStorageAdapter#afterUpdateMany\r\n   * @method\r\n   */\r\n  afterUpdateMany: noop2,\r\n\r\n  /**\r\n   * @name LocalStorageAdapter#beforeCreate\r\n   * @method\r\n   */\r\n  beforeCreate: noop,\r\n\r\n  /**\r\n   * @name LocalStorageAdapter#beforeCreateMany\r\n   * @method\r\n   */\r\n  beforeCreateMany: noop,\r\n\r\n  /**\r\n   * @name LocalStorageAdapter#beforeDEL\r\n   * @method\r\n   */\r\n  beforeDEL: noop,\r\n\r\n  /**\r\n   * @name LocalStorageAdapter#beforeDestroy\r\n   * @method\r\n   */\r\n  beforeDestroy: noop,\r\n\r\n  /**\r\n   * @name LocalStorageAdapter#beforeDestroyAll\r\n   * @method\r\n   */\r\n  beforeDestroyAll: noop,\r\n\r\n  /**\r\n   * @name LocalStorageAdapter#beforeFind\r\n   * @method\r\n   */\r\n  beforeFind: noop,\r\n\r\n  /**\r\n   * @name LocalStorageAdapter#beforeFindAll\r\n   * @method\r\n   */\r\n  beforeFindAll: noop,\r\n\r\n  /**\r\n   * @name LocalStorageAdapter#beforeGET\r\n   * @method\r\n   */\r\n  beforeGET: noop,\r\n\r\n  /**\r\n   * @name LocalStorageAdapter#beforePUT\r\n   * @method\r\n   */\r\n  beforePUT: noop,\r\n\r\n  /**\r\n   * @name LocalStorageAdapter#beforeUpdate\r\n   * @method\r\n   */\r\n  beforeUpdate: noop,\r\n\r\n  /**\r\n   * @name LocalStorageAdapter#beforeUpdateAll\r\n   * @method\r\n   */\r\n  beforeUpdateAll: noop,\r\n\r\n  /**\r\n   * @name LocalStorageAdapter#beforeUpdateMany\r\n   * @method\r\n   */\r\n  beforeUpdateMany: noop,\r\n\r\n  _create (mapper, props, opts) {\r\n    const self = this\r\n    const _props = {}\r\n    const relationFields = mapper.relationFields || []\r\n    forOwn(props, function (value, key) {\r\n      if (relationFields.indexOf(key) === -1) {\r\n        _props[key] = value\r\n      }\r\n    })\r\n    const id = get(_props, mapper.idAttribute) || guid()\r\n    set(_props, mapper.idAttribute, id)\r\n    const key = self.getIdPath(mapper, opts, id)\r\n\r\n    // Create the record\r\n    // TODO: Create related records when the \"with\" option is provided\r\n    self.storage.setItem(key, toJson(_props))\r\n    self.ensureId(id, mapper, opts)\r\n    return fromJson(self.storage.getItem(key))\r\n  },\r\n\r\n  /**\r\n   * Create a new record.\r\n   *\r\n   * @name LocalStorageAdapter#create\r\n   * @method\r\n   * @param {Object} mapper The mapper.\r\n   * @param {Object} props The record to be created.\r\n   * @param {Object} [opts] Configuration options.\r\n   * @param {boolean} [opts.raw=false] TODO\r\n   * @return {Promise}\r\n   */\r\n  create (mapper, props, opts) {\r\n    const self = this\r\n    props || (props = {})\r\n    opts || (opts = {})\r\n\r\n    return createTask(function (success, failure) {\r\n      queueTask(function () {\r\n        let op\r\n        // beforeCreate lifecycle hook\r\n        op = opts.op = 'beforeCreate'\r\n        return resolve(self[op](mapper, props, opts)).then(function (_props) {\r\n          // Allow for re-assignment from lifecycle hook\r\n          let record = isUndefined(_props) ? props : _props\r\n          record = self._create(mapper, record, opts)\r\n          // afterCreate lifecycle hook\r\n          op = opts.op = 'afterCreate'\r\n          return self[op](mapper, props, opts, record).then(function (_record) {\r\n            // Allow for re-assignment from lifecycle hook\r\n            record = isUndefined(_record) ? record : _record\r\n            return opts.raw ? {\r\n              data: record,\r\n              created: 1\r\n            } : record\r\n          })\r\n        }).then(success, failure)\r\n      })\r\n    })\r\n  },\r\n\r\n  /**\r\n   * Create multiple records in a single batch.\r\n   *\r\n   * @name LocalStorageAdapter#createMany\r\n   * @method\r\n   * @param {Object} mapper The mapper.\r\n   * @param {Array} props Array of records to be created.\r\n   * @param {Object} [opts] Configuration options.\r\n   * @param {boolean} [opts.raw=false] TODO\r\n   * @return {Promise}\r\n   */\r\n  createMany (mapper, props, opts) {\r\n    const self = this\r\n    props || (props = {})\r\n    opts || (opts = {})\r\n\r\n    return createTask(function (success, failure) {\r\n      queueTask(function () {\r\n        let op\r\n        // beforeCreateMany lifecycle hook\r\n        op = opts.op = 'beforeCreateMany'\r\n        return resolve(self[op](mapper, props, opts)).then(function (_props) {\r\n          // Allow for re-assignment from lifecycle hook\r\n          let records = isUndefined(_props) ? props : _props\r\n          records = records.map(function (record) {\r\n            return self._create(mapper, record, opts)\r\n          })\r\n          // afterCreateMany lifecycle hook\r\n          op = opts.op = 'afterCreateMany'\r\n          return self[op](mapper, props, opts, records).then(function (_records) {\r\n            // Allow for re-assignment from lifecycle hook\r\n            records = isUndefined(_records) ? records : _records\r\n            return opts.raw ? {\r\n              data: records,\r\n              created: records.length\r\n            } : records\r\n          })\r\n        }).then(success, failure)\r\n      })\r\n    })\r\n  },\r\n\r\n  /**\r\n   * @name LocalStorageAdapter#dbg\r\n   * @method\r\n   */\r\n  dbg (...args) {\r\n    this.log('debug', ...args)\r\n  },\r\n\r\n  /**\r\n   * Destroy the record with the given primary key.\r\n   *\r\n   * @name LocalStorageAdapter#destroy\r\n   * @method\r\n   * @param {Object} mapper The mapper.\r\n   * @param {(string|number)} id Primary key of the record to destroy.\r\n   * @param {Object} [opts] Configuration options.\r\n   * @param {boolean} [opts.raw=false] TODO\r\n   * @return {Promise}\r\n   */\r\n  destroy (mapper, id, opts) {\r\n    const self = this\r\n    opts || (opts = {})\r\n\r\n    return createTask(function (success, failure) {\r\n      queueTask(function () {\r\n        let op\r\n        // beforeDestroy lifecycle hook\r\n        op = opts.op = 'beforeDestroy'\r\n        return resolve(self[op](mapper, id, opts)).then(function () {\r\n          op = opts.op = 'destroy'\r\n          self.dbg(op, id, opts)\r\n          // Destroy the record\r\n          // TODO: Destroy related records when the \"with\" option is provided\r\n          self.storage.removeItem(self.getIdPath(mapper, opts, id))\r\n          self.removeId(id, mapper, opts)\r\n\r\n          // afterDestroy lifecycle hook\r\n          op = opts.op = 'afterDestroy'\r\n          return self[op](mapper, id, opts).then(function (_id) {\r\n            // Allow for re-assignment from lifecycle hook\r\n            id = isUndefined(_id) ? id : _id\r\n            return opts.raw ? {\r\n              data: id,\r\n              deleted: 1\r\n            } : id\r\n          })\r\n        }).then(success, failure)\r\n      })\r\n    })\r\n  },\r\n\r\n  /**\r\n   * Destroy the records that match the selection `query`.\r\n   *\r\n   * @name LocalStorageAdapter#destroyAll\r\n   * @method\r\n   * @param {Object} mapper The mapper.\r\n   * @param {Object} query Selection query.\r\n   * @param {Object} [opts] Configuration opts.\r\n   * @param {boolean} [opts.raw=false] TODO\r\n   * @return {Promise}\r\n   */\r\n  destroyAll (mapper, query, opts) {\r\n    const self = this\r\n    query || (query = {})\r\n    opts || (opts = {})\r\n\r\n    return createTask(function (success, failure) {\r\n      queueTask(function () {\r\n        let op\r\n        // beforeDestroyAll lifecycle hook\r\n        op = opts.op = 'beforeDestroyAll'\r\n        return resolve(self[op](mapper, query, opts)).then(function () {\r\n          op = opts.op = 'destroyAll'\r\n          self.dbg(op, query, opts)\r\n          // Find the records that are to be destroyed\r\n          return self.findAll(mapper, query, opts)\r\n        }).then(function (records) {\r\n          const idAttribute = mapper.idAttribute\r\n          // Gather IDs of records to be destroyed\r\n          let ids = records.map(function (record) {\r\n            return get(record, idAttribute)\r\n          })\r\n          // Destroy each record\r\n          // TODO: Destroy related records when the \"with\" option is provided\r\n          ids.forEach(function (id) {\r\n            self.storage.removeItem(self.getIdPath(mapper, opts, id))\r\n          })\r\n          self.removeId(ids, mapper, opts)\r\n\r\n          // afterDestroyAll lifecycle hook\r\n          op = opts.op = 'afterDestroyAll'\r\n          return self[op](mapper, query, opts, ids).then(function (_ids) {\r\n            // Allow for re-assignment from lifecycle hook\r\n            ids = isUndefined(_ids) ? ids : _ids\r\n            return opts.raw ? {\r\n              data: ids,\r\n              deleted: records.length\r\n            } : ids\r\n          })\r\n        }).then(success, failure)\r\n      })\r\n    })\r\n  },\r\n\r\n  /**\r\n   * TODO\r\n   *\r\n   * @name LocalStorageAdapter#ensureId\r\n   * @method\r\n   */\r\n  ensureId (id, mapper, opts) {\r\n    const ids = this.getIds(mapper, opts)\r\n    if (isArray(id)) {\r\n      if (!id.length) {\r\n        return\r\n      }\r\n      id.forEach(function (_id) {\r\n        ids[_id] = 1\r\n      })\r\n    } else {\r\n      ids[id] = 1\r\n    }\r\n    this.saveKeys(ids, mapper, opts)\r\n  },\r\n\r\n  /**\r\n   * Retrieve the record with the given primary key.\r\n   *\r\n   * @name LocalStorageAdapter#find\r\n   * @method\r\n   * @param {Object} mapper The mapper.\r\n   * @param {(string|number)} id Primary key of the record to retrieve.\r\n   * @param {Object} [opts] Configuration options.\r\n   * @param {boolean} [opts.raw=false] TODO\r\n   * @param {string[]} [opts.with=[]] TODO\r\n   * @return {Promise}\r\n   */\r\n  find (mapper, id, opts) {\r\n    const self = this\r\n    let record, op\r\n    opts || (opts = {})\r\n    opts.with || (opts.with = [])\r\n\r\n    // beforeFind lifecycle hook\r\n    op = opts.op = 'beforeFind'\r\n    return resolve(self[op](mapper, id, opts)).then(function () {\r\n      op = opts.op = 'find'\r\n      self.dbg(op, id, opts)\r\n      const key = self.getIdPath(mapper, opts, id)\r\n      record = self.storage.getItem(key)\r\n      if (isUndefined(record)) {\r\n        record = undefined\r\n        return\r\n      }\r\n      record = fromJson(record)\r\n      const tasks = []\r\n\r\n      forEachRelation(mapper, opts, function (def, __opts) {\r\n        const relatedMapper = def.getRelation()\r\n        let task\r\n\r\n        if ((def.type === 'hasOne' || def.type === 'hasMany') && def.foreignKey) {\r\n          task = self.findAll(relatedMapper, {\r\n            [def.foreignKey]: get(record, mapper.idAttribute)\r\n          }, __opts).then(function (relatedItems) {\r\n            if (def.type === 'hasOne' && relatedItems.length) {\r\n              set(record, def.localField, relatedItems[0])\r\n            } else {\r\n              set(record, def.localField, relatedItems)\r\n            }\r\n            return relatedItems\r\n          })\r\n        } else if (def.type === 'hasMany' && def.localKeys) {\r\n          let localKeys = []\r\n          let itemKeys = get(record, def.localKeys) || []\r\n          itemKeys = Array.isArray(itemKeys) ? itemKeys : Object.keys(itemKeys)\r\n          localKeys = localKeys.concat(itemKeys || [])\r\n          task = self.findAll(relatedMapper, {\r\n            where: {\r\n              [relatedMapper.idAttribute]: {\r\n                'in': unique(localKeys).filter(function (x) { return x })\r\n              }\r\n            }\r\n          }, __opts).then(function (relatedItems) {\r\n            set(record, def.localField, relatedItems)\r\n            return relatedItems\r\n          })\r\n        } else if (def.type === 'belongsTo') {\r\n          task = self.find(relatedMapper, get(record, def.foreignKey), __opts).then(function (relatedItem) {\r\n            set(record, def.localField, relatedItem)\r\n            return relatedItem\r\n          })\r\n        }\r\n\r\n        if (task) {\r\n          tasks.push(task)\r\n        }\r\n      })\r\n\r\n      return Promise.all(tasks)\r\n    }).then(function () {\r\n      // afterFind lifecycle hook\r\n      op = opts.op = 'afterFind'\r\n      return resolve(self[op](mapper, id, opts, record)).then(function (_record) {\r\n        // Allow for re-assignment from lifecycle hook\r\n        record = isUndefined(_record) ? record : _record\r\n        return opts.raw ? {\r\n          data: record,\r\n          found: record ? 1 : 0\r\n        } : record\r\n      })\r\n    })\r\n  },\r\n\r\n  /**\r\n   * Retrieve the records that match the selection `query`.\r\n   *\r\n   * @name LocalStorageAdapter#findAll\r\n   * @method\r\n   * @param {Object} mapper The mapper.\r\n   * @param {Object} query Selection query.\r\n   * @param {Object} [opts] Configuration options.\r\n   * @param {boolean} [opts.raw=false] TODO\r\n   * @param {string[]} [opts.with=[]] TODO\r\n   * @return {Promise}\r\n   */\r\n  findAll (mapper, query, opts) {\r\n    const self = this\r\n    let records = []\r\n    let op\r\n    opts || (opts = {})\r\n    opts.with || (opts.with = [])\r\n\r\n    // beforeFindAll lifecycle hook\r\n    op = opts.op = 'beforeFindAll'\r\n    return resolve(self[op](mapper, query, opts)).then(function () {\r\n      op = opts.op = 'findAll'\r\n      self.dbg(op, query, opts)\r\n\r\n      // Load all records into memory...\r\n      const ids = self.getIds(mapper, opts)\r\n      forOwn(ids, function (value, id) {\r\n        const json = self.storage.getItem(self.getIdPath(mapper, opts, id))\r\n        if (json) {\r\n          records.push(fromJson(json))\r\n        }\r\n      })\r\n      const idAttribute = mapper.idAttribute\r\n      // TODO: Verify that this collection gets properly garbage collected\r\n      // TODO: Or, find a way to filter without using Collection\r\n      const _query = new Query({\r\n        index: {\r\n          getAll () {\r\n            return records\r\n          }\r\n        }\r\n      })\r\n      records = _query.filter(query).run()\r\n      const tasks = []\r\n\r\n      forEachRelation(mapper, opts, function (def, __opts) {\r\n        const relatedMapper = def.getRelation()\r\n        let task\r\n\r\n        if ((def.type === 'hasOne' || def.type === 'hasMany') && def.foreignKey) {\r\n          task = self.findAll(relatedMapper, {\r\n            where: {\r\n              [def.foreignKey]: {\r\n                'in': records.map(function (item) {\r\n                  return get(item, idAttribute)\r\n                }).filter(function (x) { return x })\r\n              }\r\n            }\r\n          }, __opts).then(function (relatedItems) {\r\n            records.forEach(function (item) {\r\n              const attached = []\r\n              relatedItems.forEach(function (relatedItem) {\r\n                if (get(relatedItem, def.foreignKey) === get(item, idAttribute)) {\r\n                  attached.push(relatedItem)\r\n                }\r\n              })\r\n              if (def.type === 'hasOne' && attached.length) {\r\n                set(item, def.localField, attached[0])\r\n              } else {\r\n                set(item, def.localField, attached)\r\n              }\r\n            })\r\n            return relatedItems\r\n          })\r\n        } else if (def.type === 'hasMany' && def.localKeys) {\r\n          let localKeys = []\r\n          records.forEach(function (item) {\r\n            let itemKeys = get(item, def.localKeys) || []\r\n            itemKeys = Array.isArray(itemKeys) ? itemKeys : Object.keys(itemKeys)\r\n            localKeys = localKeys.concat(itemKeys || [])\r\n          })\r\n          task = self.findAll(relatedMapper, {\r\n            where: {\r\n              [relatedMapper.idAttribute]: {\r\n                'in': unique(localKeys).filter(function (x) { return x })\r\n              }\r\n            }\r\n          }, __opts).then(function (relatedItems) {\r\n            records.forEach(function (item) {\r\n              const attached = []\r\n              let itemKeys = get(item, def.localKeys) || []\r\n              itemKeys = Array.isArray(itemKeys) ? itemKeys : Object.keys(itemKeys)\r\n              relatedItems.forEach(function (relatedItem) {\r\n                if (itemKeys && itemKeys.indexOf(relatedItem[relatedMapper.idAttribute]) !== -1) {\r\n                  attached.push(relatedItem)\r\n                }\r\n              })\r\n              set(item, def.localField, attached)\r\n            })\r\n            return relatedItems\r\n          })\r\n        } else if (def.type === 'belongsTo') {\r\n          task = self.findAll(relatedMapper, {\r\n            where: {\r\n              [relatedMapper.idAttribute]: {\r\n                'in': records.map(function (item) {\r\n                  return get(item, def.foreignKey)\r\n                }).filter(function (x) { return x })\r\n              }\r\n            }\r\n          }, __opts).then(function (relatedItems) {\r\n            records.forEach(function (item) {\r\n              relatedItems.forEach(function (relatedItem) {\r\n                if (relatedItem[relatedMapper.idAttribute] === get(item, def.foreignKey)) {\r\n                  set(item, def.localField, relatedItem)\r\n                }\r\n              })\r\n            })\r\n            return relatedItems\r\n          })\r\n        }\r\n\r\n        if (task) {\r\n          tasks.push(task)\r\n        }\r\n      })\r\n      return Promise.all(tasks)\r\n    }).then(function () {\r\n      // afterFindAll lifecycle hook\r\n      op = opts.op = 'afterFindAll'\r\n      return resolve(self[op](mapper, query, opts, records)).then(function (_records) {\r\n        // Allow for re-assignment from lifecycle hook\r\n        records = isUndefined(_records) ? records : _records\r\n        return opts.raw ? {\r\n          data: records,\r\n          found: records.length\r\n        } : records\r\n      })\r\n    })\r\n  },\r\n\r\n  /**\r\n   * TODO\r\n   *\r\n   * @name LocalStorageAdapter#getPath\r\n   * @method\r\n   */\r\n  getPath (mapper, opts) {\r\n    opts = opts || {}\r\n    return makePath(opts.basePath === undefined ? (mapper.basePath === undefined ? this.basePath : mapper.basePath) : opts.basePath, mapper.name)\r\n  },\r\n\r\n  /**\r\n   * TODO\r\n   *\r\n   * @name LocalStorageAdapter#getIdPath\r\n   * @method\r\n   */\r\n  getIdPath (mapper, opts, id) {\r\n    opts = opts || {}\r\n    return makePath(opts.basePath || this.basePath || mapper.basePath, mapper.endpoint, id)\r\n  },\r\n\r\n  /**\r\n   * TODO\r\n   *\r\n   * @name LocalStorageAdapter#getIds\r\n   * @method\r\n   */\r\n  getIds (mapper, opts) {\r\n    let ids\r\n    const idsPath = this.getPath(mapper, opts)\r\n    const idsJson = this.storage.getItem(idsPath)\r\n    if (idsJson) {\r\n      ids = fromJson(idsJson)\r\n    } else {\r\n      ids = {}\r\n    }\r\n    return ids\r\n  },\r\n\r\n  /**\r\n   * TODO\r\n   *\r\n   * @name LocalStorageAdapter#log\r\n   * @method\r\n   */\r\n  log (level, ...args) {\r\n    if (level && !args.length) {\r\n      args.push(level)\r\n      level = 'debug'\r\n    }\r\n    if (level === 'debug' && !this.debug) {\r\n      return\r\n    }\r\n    const prefix = `${level.toUpperCase()}: (LocalStorageAdapter)`\r\n    if (console[level]) {\r\n      console[level](prefix, ...args)\r\n    } else {\r\n      console.log(prefix, ...args)\r\n    }\r\n  },\r\n\r\n  /**\r\n   * TODO\r\n   *\r\n   * @name LocalStorageAdapter#removeId\r\n   * @method\r\n   */\r\n  removeId (id, mapper, opts) {\r\n    const ids = this.getIds(mapper, opts)\r\n    if (isArray(id)) {\r\n      if (!id.length) {\r\n        return\r\n      }\r\n      id.forEach(function (_id) {\r\n        delete ids[_id]\r\n      })\r\n    } else {\r\n      delete ids[id]\r\n    }\r\n    this.saveKeys(ids, mapper, opts)\r\n  },\r\n\r\n  /**\r\n   * TODO\r\n   *\r\n   * @name LocalStorageAdapter#saveKeys\r\n   * @method\r\n   */\r\n  saveKeys (ids, mapper, opts) {\r\n    ids = ids || {}\r\n    const idsPath = this.getPath(mapper, opts)\r\n    if (Object.keys(ids).length) {\r\n      this.storage.setItem(idsPath, toJson(ids))\r\n    } else {\r\n      this.storage.removeItem(idsPath)\r\n    }\r\n  },\r\n\r\n  /**\r\n   * Update the records that match the selection `query`. If a record with the\r\n   * specified primary key cannot be found then no update is performed and the\r\n   * promise is resolved with `undefined`.\r\n   *\r\n   * @name LocalStorageAdapter#update\r\n   * @method\r\n   * @param {Object} mapper The mapper.\r\n   * @param {(string|number)} id The primary key of the record to be updated.\r\n   * @param {Object} props The update to apply to the record.\r\n   * @param {Object} [opts] Configuration options.\r\n   * @param {boolean} [opts.raw=false] TODO\r\n   * @return {Promise}\r\n   */\r\n  update (mapper, id, props, opts) {\r\n    const self = this\r\n    props || (props = {})\r\n    opts || (opts = {})\r\n\r\n    return createTask(function (success, failure) {\r\n      queueTask(function () {\r\n        let op\r\n        // beforeUpdate lifecycle hook\r\n        op = opts.op = 'beforeUpdate'\r\n        return resolve(self[op](mapper, id, props, opts)).then(function (_props) {\r\n          // Allow for re-assignment from lifecycle hook\r\n          props = isUndefined(_props) ? props : _props\r\n          const key = self.getIdPath(mapper, opts, id)\r\n          let record = self.storage.getItem(key)\r\n          record = record ? fromJson(record) : undefined\r\n          let updated = 0\r\n\r\n          // Update the record\r\n          // TODO: Update related records when the \"with\" option is provided\r\n          if (record) {\r\n            deepMixIn(record, props)\r\n            self.storage.setItem(key, toJson(record))\r\n            updated++\r\n          }\r\n\r\n          // afterUpdate lifecycle hook\r\n          op = opts.op = 'afterUpdate'\r\n          return self[op](mapper, id, props, opts, record).then(function (_record) {\r\n            // Allow for re-assignment from lifecycle hook\r\n            record = isUndefined(_record) ? record : _record\r\n            return opts.raw ? {\r\n              data: record,\r\n              updated\r\n            } : record\r\n          })\r\n        }).then(success, failure)\r\n      })\r\n    })\r\n  },\r\n\r\n  /**\r\n   * Update the records that match the selection `query`.\r\n   *\r\n   * @name LocalStorageAdapter#updateAll\r\n   * @method\r\n   * @param {Object} mapper The mapper.\r\n   * @param {Object} props The update to apply to the selected records.\r\n   * @param {Object} query Selection query.\r\n   * @param {Object} [opts] Configuration options.\r\n   * @return {Promise}\r\n   */\r\n  updateAll (mapper, props, query, opts) {\r\n    const self = this\r\n    props || (props = {})\r\n    query || (query = {})\r\n    opts || (opts = {})\r\n\r\n    return createTask(function (success, failure) {\r\n      queueTask(function () {\r\n        let op\r\n        // beforeUpdateAll lifecycle hook\r\n        op = opts.op = 'beforeUpdateAll'\r\n        return resolve(self[op](mapper, props, query, opts)).then(function (_props) {\r\n          // Allow for re-assignment from lifecycle hook\r\n          props = isUndefined(_props) ? props : _props\r\n          op = opts.op = 'updateAll'\r\n          self.dbg(op, query, opts)\r\n\r\n          // Find the records that are to be updated\r\n          return self.findAll(mapper, query, opts)\r\n        }).then(function (records) {\r\n          const idAttribute = mapper.idAttribute\r\n          let updated = 0\r\n\r\n          // Update each record\r\n          // TODO: Update related records when the \"with\" option is provided\r\n          records.forEach(function (record) {\r\n            record || (record = {})\r\n            const id = get(record, idAttribute)\r\n            const key = self.getIdPath(mapper, opts, id)\r\n            deepMixIn(record, props)\r\n            self.storage.setItem(key, toJson(record))\r\n            updated++\r\n          })\r\n\r\n          // afterUpdateAll lifecycle hook\r\n          op = opts.op = 'afterUpdateAll'\r\n          return self[op](mapper, props, query, opts, records).then(function (_records) {\r\n            // Allow for re-assignment from lifecycle hook\r\n            records = isUndefined(_records) ? records : _records\r\n            return opts.raw ? {\r\n              data: records,\r\n              updated\r\n            } : records\r\n          })\r\n        }).then(success, failure)\r\n      })\r\n    })\r\n  },\r\n\r\n  /**\r\n   * Update the given records in a single batch.\r\n   *\r\n   * @name LocalStorageAdapter#updateMany\r\n   * @method\r\n   * @param {Object} mapper The mapper.\r\n   * @param {Object} records The records to update.\r\n   * @param {Object} [opts] Configuration options.\r\n   * @param {boolean} [opts.raw=false] TODO\r\n   * @return {Promise}\r\n   */\r\n  updateMany (mapper, records, opts) {\r\n    const self = this\r\n    records || (records = [])\r\n    opts || (opts = {})\r\n\r\n    return createTask(function (success, failure) {\r\n      queueTask(function () {\r\n        let op\r\n        let updatedRecords = []\r\n        // beforeUpdateMany lifecycle hook\r\n        op = opts.op = 'beforeUpdateMany'\r\n        return resolve(self[op](mapper, records, opts)).then(function (_records) {\r\n          // Allow for re-assignment from lifecycle hook\r\n          records = isUndefined(_records) ? records : _records\r\n          op = opts.op = 'updateMany'\r\n          self.dbg(op, records, opts)\r\n\r\n          const idAttribute = mapper.idAttribute\r\n\r\n          // Update each record\r\n          // TODO: Update related records when the \"with\" option is provided\r\n          records.forEach(function (record) {\r\n            if (!record) {\r\n              return\r\n            }\r\n            const id = get(record, idAttribute)\r\n            if (isUndefined(id)) {\r\n              return\r\n            }\r\n            const key = self.getIdPath(mapper, opts, id)\r\n            let json = self.storage.getItem(key)\r\n            const existingRecord = json ? fromJson(json) : undefined\r\n            if (!existingRecord) {\r\n              return\r\n            }\r\n            deepMixIn(existingRecord, record)\r\n            self.storage.setItem(key, toJson(existingRecord))\r\n            updatedRecords.push(existingRecord)\r\n          })\r\n\r\n          // afterUpdateMany lifecycle hook\r\n          op = opts.op = 'afterUpdateMany'\r\n          return self[op](mapper, records, opts, updatedRecords).then(function (_records) {\r\n            // Allow for re-assignment from lifecycle hook\r\n            records = isUndefined(_records) ? updatedRecords : _records\r\n            return opts.raw ? {\r\n              data: records,\r\n              updated: updatedRecords.length\r\n            } : records\r\n          })\r\n        }).then(success, failure)\r\n      })\r\n    })\r\n  }\r\n})\r\n\r\n/**\r\n * Details of the current version of the `js-data-localstorage` module.\r\n *\r\n * @name LocalStorageAdapter.version\r\n * @type {Object}\r\n * @property {string} version.full The full semver value.\r\n * @property {number} version.major The major version number.\r\n * @property {number} version.minor The minor version number.\r\n * @property {number} version.patch The patch version number.\r\n * @property {(string|boolean)} version.alpha The alpha version value,\r\n * otherwise `false` if the current version is not alpha.\r\n * @property {(string|boolean)} version.beta The beta version value,\r\n * otherwise `false` if the current version is not beta.\r\n */\r\nLocalStorageAdapter.version = {\r\n  full: '<%= pkg.version %>',\r\n  major: parseInt('<%= major %>', 10),\r\n  minor: parseInt('<%= minor %>', 10),\r\n  patch: parseInt('<%= patch %>', 10),\r\n  alpha: '<%= alpha %>' !== 'false' ? '<%= alpha %>' : false,\r\n  beta: '<%= beta %>' !== 'false' ? '<%= beta %>' : false\r\n}\r\n\r\n/**\r\n * Registered as `js-data-localstorage` in NPM and Bower.\r\n *\r\n * __Script tag__:\r\n * ```javascript\r\n * window.LocalStorageAdapter\r\n * ```\r\n * __CommonJS__:\r\n * ```javascript\r\n * var LocalStorageAdapter = require('js-data-localstorage')\r\n * ```\r\n * __ES6 Modules__:\r\n * ```javascript\r\n * import LocalStorageAdapter from 'js-data-localstorage'\r\n * ```\r\n * __AMD__:\r\n * ```javascript\r\n * define('myApp', ['js-data-localstorage'], function (LocalStorageAdapter) { ... })\r\n * ```\r\n *\r\n * @module js-data-localstorage\r\n */\r\n\r\nmodule.exports = LocalStorageAdapter\r\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/index.js\n **/","module.exports = __WEBPACK_EXTERNAL_MODULE_1__;\n\n\n/*****************\n ** WEBPACK FOOTER\n ** external {\"amd\":\"js-data\",\"commonjs\":\"js-data\",\"commonjs2\":\"js-data\",\"root\":\"JSData\"}\n ** module id = 1\n ** module chunks = 0\n **/","var randHex = require('./randHex');\nvar choice = require('./choice');\n\n  /**\n   * Returns pseudo-random guid (UUID v4)\n   * IMPORTANT: it's not totally \"safe\" since randHex/choice uses Math.random\n   * by default and sequences can be predicted in some cases. See the\n   * \"random/random\" documentation for more info about it and how to replace\n   * the default PRNG.\n   */\n  function guid() {\n    return (\n        randHex(8)+'-'+\n        randHex(4)+'-'+\n        // v4 UUID always contain \"4\" at this position to specify it was\n        // randomly generated\n        '4' + randHex(3) +'-'+\n        // v4 UUID always contain chars [a,b,8,9] at this position\n        choice(8, 9, 'a', 'b') + randHex(3)+'-'+\n        randHex(12)\n    );\n  }\n  module.exports = guid;\n\n\n\n\n/*****************\n ** WEBPACK FOOTER\n ** ./~/mout/random/guid.js\n ** module id = 2\n ** module chunks = 0\n **/","var choice = require('./choice');\n\n    var _chars = '0123456789abcdef'.split('');\n\n    /**\n     * Returns a random hexadecimal string\n     */\n    function randHex(size){\n        size = size && size > 0? size : 6;\n        var str = '';\n        while (size--) {\n            str += choice(_chars);\n        }\n        return str;\n    }\n\n    module.exports = randHex;\n\n\n\n\n\n/*****************\n ** WEBPACK FOOTER\n ** ./~/mout/random/randHex.js\n ** module id = 3\n ** module chunks = 0\n **/","var randInt = require('./randInt');\nvar isArray = require('../lang/isArray');\n\n    /**\n     * Returns a random element from the supplied arguments\n     * or from the array (if single argument is an array).\n     */\n    function choice(items) {\n        var target = (arguments.length === 1 && isArray(items))? items : arguments;\n        return target[ randInt(0, target.length - 1) ];\n    }\n\n    module.exports = choice;\n\n\n\n\n\n/*****************\n ** WEBPACK FOOTER\n ** ./~/mout/random/choice.js\n ** module id = 4\n ** module chunks = 0\n **/","var MIN_INT = require('../number/MIN_INT');\nvar MAX_INT = require('../number/MAX_INT');\nvar rand = require('./rand');\n\n    /**\n     * Gets random integer inside range or snap to min/max values.\n     */\n    function randInt(min, max){\n        min = min == null? MIN_INT : ~~min;\n        max = max == null? MAX_INT : ~~max;\n        // can't be max + 0.5 otherwise it will round up if `rand`\n        // returns `max` causing it to overflow range.\n        // -0.5 and + 0.49 are required to avoid bias caused by rounding\n        return Math.round( rand(min - 0.5, max + 0.499999999999) );\n    }\n\n    module.exports = randInt;\n\n\n\n\n/*****************\n ** WEBPACK FOOTER\n ** ./~/mout/random/randInt.js\n ** module id = 5\n ** module chunks = 0\n **/","/**\n * @constant Minimum 32-bit signed integer value (-2^31).\n */\n\n    module.exports = -2147483648;\n\n\n\n\n/*****************\n ** WEBPACK FOOTER\n ** ./~/mout/number/MIN_INT.js\n ** module id = 6\n ** module chunks = 0\n **/","/**\n * @constant Maximum 32-bit signed integer value. (2^31 - 1)\n */\n\n    module.exports = 2147483647;\n\n\n\n\n/*****************\n ** WEBPACK FOOTER\n ** ./~/mout/number/MAX_INT.js\n ** module id = 7\n ** module chunks = 0\n **/","var random = require('./random');\nvar MIN_INT = require('../number/MIN_INT');\nvar MAX_INT = require('../number/MAX_INT');\n\n    /**\n     * Returns random number inside range\n     */\n    function rand(min, max){\n        min = min == null? MIN_INT : min;\n        max = max == null? MAX_INT : max;\n        return min + (max - min) * random();\n    }\n\n    module.exports = rand;\n\n\n\n\n/*****************\n ** WEBPACK FOOTER\n ** ./~/mout/random/rand.js\n ** module id = 8\n ** module chunks = 0\n **/","\n\n    /**\n     * Just a wrapper to Math.random. No methods inside mout/random should call\n     * Math.random() directly so we can inject the pseudo-random number\n     * generator if needed (ie. in case we need a seeded random or a better\n     * algorithm than the native one)\n     */\n    function random(){\n        return random.get();\n    }\n\n    // we expose the method so it can be swapped if needed\n    random.get = Math.random;\n\n    module.exports = random;\n\n\n\n\n\n/*****************\n ** WEBPACK FOOTER\n ** ./~/mout/random/random.js\n ** module id = 9\n ** module chunks = 0\n **/","var isKind = require('./isKind');\n    /**\n     */\n    var isArray = Array.isArray || function (val) {\n        return isKind(val, 'Array');\n    };\n    module.exports = isArray;\n\n\n\n\n/*****************\n ** WEBPACK FOOTER\n ** ./~/mout/lang/isArray.js\n ** module id = 10\n ** module chunks = 0\n **/","var kindOf = require('./kindOf');\n    /**\n     * Check if value is from a specific \"kind\".\n     */\n    function isKind(val, kind){\n        return kindOf(val) === kind;\n    }\n    module.exports = isKind;\n\n\n\n\n/*****************\n ** WEBPACK FOOTER\n ** ./~/mout/lang/isKind.js\n ** module id = 11\n ** module chunks = 0\n **/","\n\n    var _rKind = /^\\[object (.*)\\]$/,\n        _toString = Object.prototype.toString,\n        UNDEF;\n\n    /**\n     * Gets the \"kind\" of value. (e.g. \"String\", \"Number\", etc)\n     */\n    function kindOf(val) {\n        if (val === null) {\n            return 'Null';\n        } else if (val === UNDEF) {\n            return 'Undefined';\n        } else {\n            return _rKind.exec( _toString.call(val) )[1];\n        }\n    }\n    module.exports = kindOf;\n\n\n\n\n/*****************\n ** WEBPACK FOOTER\n ** ./~/mout/lang/kindOf.js\n ** module id = 12\n ** module chunks = 0\n **/"],"sourceRoot":""}